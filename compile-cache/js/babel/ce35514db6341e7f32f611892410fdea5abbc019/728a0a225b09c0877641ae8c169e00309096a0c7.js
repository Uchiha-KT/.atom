Object.defineProperty(exports, '__esModule', {
  value: true
});
/** @babel */

var Config = atom.config;
var ua = require('universal-analytics');
var trackingId = 'UA-47544457-3';

var user = null;

function getUser() {
  var userId = atom.config.get("git-plus.general._analyticsUserId");
  if (!atom.config.get("git-plus.general._analyticsUserId")) {
    userId = require("uuid").v4();
    atom.config.set("git-plus.general._analyticsUserId", userId);
  }
  if (user === null) {
    user = ua(trackingId, userId, {
      headers: {
        "User-Agent": navigator.userAgent
      }
    });
  }
  return user;
}

function trackBooleanConfigIsOn(name) {
  getUser().event('Config', 'ON', name, { anonymizeIp: true }).send();
}

function trackBooleanConfigIsOff(name) {
  getUser().event('Config', 'OFF', name, { anonymizeIp: true }).send();
}

function trackIntConfigIsOn(name, value) {
  getUser().event('Config', 'ON', name, value, { anonymizeIp: true }).send();
}

function trackStringConfig(name, value) {
  getUser().event('Config', 'ON', name + ':' + value, { anonymizeIp: true }).send();
}

function trackConfig(name, value) {
  if (parseInt(value) >= 0) {
    trackIntConfigIsOn(name, value);
  } else if (value === true) {
    trackBooleanConfigIsOn(name);
  } else if (value === false) {
    trackBooleanConfigIsOff(name);
  } else if (value.charAt) {
    trackStringConfig(name, value);
  }
}

function track(name) {
  var configKey = 'git-plus.' + name;
  var config = Config.get(configKey);
  var schema = Config.getSchema(configKey);
  if (configKey === 'git-plus.general._analyticsUserId') return;
  if (schema.type === 'object') {
    Object.keys(schema.properties).forEach(function (property) {
      return track(name + '.' + property);
    });
  } else {
    trackConfig(configKey, config);
  }
}

// function trackConfigChanged(name, {oldValue, newValue}) {
//   getUser().event('Config', 'CHANGED', name, {anonymizeIp: true}).send()
// }

exports['default'] = function () {
  // let userConfigs = Config.getAll('git-plus')[0]
  // userConfigs = userConfigs.value
  // Object.keys(userConfigs).forEach(track)
  // Object.keys(userConfigs).forEach(config => {
  //   atom.config.onDidChange(`git-plus.${config}`, event => trackConfigChanged(name, event))
  // })
};

module.exports = exports['default'];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZpbGU6Ly8vQzovVXNlcnMvdWNoaWhhLy5hdG9tL3BhY2thZ2VzL2dpdC1wbHVzL2xpYi9hbmFseXRpY3MuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQSxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFBO0FBQzFCLElBQU0sRUFBRSxHQUFHLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFBO0FBQ3pDLElBQU0sVUFBVSxHQUFHLGVBQWUsQ0FBQTs7QUFFbEMsSUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFBOztBQUVmLFNBQVMsT0FBTyxHQUFHO0FBQ2pCLE1BQUksTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLG1DQUFtQyxDQUFDLENBQUE7QUFDakUsTUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLG1DQUFtQyxDQUFDLEVBQUU7QUFDekQsVUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQTtBQUM3QixRQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxtQ0FBbUMsRUFBRSxNQUFNLENBQUMsQ0FBQTtHQUM3RDtBQUNELE1BQUksSUFBSSxLQUFLLElBQUksRUFBRTtBQUNqQixRQUFJLEdBQUcsRUFBRSxDQUFDLFVBQVUsRUFBRSxNQUFNLEVBQUU7QUFDNUIsYUFBTyxFQUFFO0FBQ1Asb0JBQVksRUFBRSxTQUFTLENBQUMsU0FBUztPQUNsQztLQUNGLENBQUMsQ0FBQTtHQUNIO0FBQ0QsU0FBTyxJQUFJLENBQUE7Q0FDWjs7QUFFRCxTQUFTLHNCQUFzQixDQUFDLElBQUksRUFBRTtBQUNwQyxTQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxXQUFXLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtDQUNsRTs7QUFFRCxTQUFTLHVCQUF1QixDQUFDLElBQUksRUFBRTtBQUNyQyxTQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBQyxXQUFXLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQTtDQUNuRTs7QUFFRCxTQUFTLGtCQUFrQixDQUFDLElBQUksRUFBRSxLQUFLLEVBQUU7QUFDdkMsU0FBTyxFQUFFLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxFQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFBO0NBQ3pFOztBQUVELFNBQVMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRTtBQUN0QyxTQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLElBQUksRUFBSyxJQUFJLFNBQUksS0FBSyxFQUFJLEVBQUMsV0FBVyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUE7Q0FDaEY7O0FBRUQsU0FBUyxXQUFXLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRTtBQUNoQyxNQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUU7QUFDeEIsc0JBQWtCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFBO0dBQ2hDLE1BQ0ksSUFBSSxLQUFLLEtBQUssSUFBSSxFQUFFO0FBQ3ZCLDBCQUFzQixDQUFDLElBQUksQ0FBQyxDQUFBO0dBQzdCLE1BQ0ksSUFBSSxLQUFLLEtBQUssS0FBSyxFQUFFO0FBQ3hCLDJCQUF1QixDQUFDLElBQUksQ0FBQyxDQUFBO0dBQzlCLE1BQ0ksSUFBSSxLQUFLLENBQUMsTUFBTSxFQUFFO0FBQ3JCLHFCQUFpQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQTtHQUMvQjtDQUNGOztBQUVELFNBQVMsS0FBSyxDQUFDLElBQUksRUFBRTtBQUNuQixNQUFNLFNBQVMsaUJBQWUsSUFBSSxBQUFFLENBQUE7QUFDcEMsTUFBTSxNQUFNLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQTtBQUNwQyxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFBO0FBQzFDLE1BQUksU0FBUyxLQUFLLG1DQUFtQyxFQUFFLE9BQU07QUFDN0QsTUFBSSxNQUFNLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRTtBQUM1QixVQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQSxRQUFRO2FBQUksS0FBSyxDQUFJLElBQUksU0FBSSxRQUFRLENBQUc7S0FBQSxDQUFDLENBQUE7R0FDakYsTUFDSTtBQUNILGVBQVcsQ0FBQyxTQUFTLEVBQUUsTUFBTSxDQUFDLENBQUE7R0FDL0I7Q0FDRjs7Ozs7O3FCQU1jLFlBQVc7Ozs7Ozs7Q0FPekIiLCJmaWxlIjoiZmlsZTovLy9DOi9Vc2Vycy91Y2hpaGEvLmF0b20vcGFja2FnZXMvZ2l0LXBsdXMvbGliL2FuYWx5dGljcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiBAYmFiZWwgKi9cblxuY29uc3QgQ29uZmlnID0gYXRvbS5jb25maWdcbmNvbnN0IHVhID0gcmVxdWlyZSgndW5pdmVyc2FsLWFuYWx5dGljcycpXG5jb25zdCB0cmFja2luZ0lkID0gJ1VBLTQ3NTQ0NDU3LTMnXG5cbmxldCB1c2VyID0gbnVsbFxuXG5mdW5jdGlvbiBnZXRVc2VyKCkge1xuICBsZXQgdXNlcklkID0gYXRvbS5jb25maWcuZ2V0KFwiZ2l0LXBsdXMuZ2VuZXJhbC5fYW5hbHl0aWNzVXNlcklkXCIpXG4gIGlmICghYXRvbS5jb25maWcuZ2V0KFwiZ2l0LXBsdXMuZ2VuZXJhbC5fYW5hbHl0aWNzVXNlcklkXCIpKSB7XG4gICAgdXNlcklkID0gcmVxdWlyZShcInV1aWRcIikudjQoKVxuICAgIGF0b20uY29uZmlnLnNldChcImdpdC1wbHVzLmdlbmVyYWwuX2FuYWx5dGljc1VzZXJJZFwiLCB1c2VySWQpXG4gIH1cbiAgaWYgKHVzZXIgPT09IG51bGwpIHtcbiAgICB1c2VyID0gdWEodHJhY2tpbmdJZCwgdXNlcklkLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiVXNlci1BZ2VudFwiOiBuYXZpZ2F0b3IudXNlckFnZW50XG4gICAgICB9XG4gICAgfSlcbiAgfVxuICByZXR1cm4gdXNlclxufVxuXG5mdW5jdGlvbiB0cmFja0Jvb2xlYW5Db25maWdJc09uKG5hbWUpIHtcbiAgZ2V0VXNlcigpLmV2ZW50KCdDb25maWcnLCAnT04nLCBuYW1lLCB7YW5vbnltaXplSXA6IHRydWV9KS5zZW5kKClcbn1cblxuZnVuY3Rpb24gdHJhY2tCb29sZWFuQ29uZmlnSXNPZmYobmFtZSkge1xuICBnZXRVc2VyKCkuZXZlbnQoJ0NvbmZpZycsICdPRkYnLCBuYW1lLCB7YW5vbnltaXplSXA6IHRydWV9KS5zZW5kKClcbn1cblxuZnVuY3Rpb24gdHJhY2tJbnRDb25maWdJc09uKG5hbWUsIHZhbHVlKSB7XG4gIGdldFVzZXIoKS5ldmVudCgnQ29uZmlnJywgJ09OJywgbmFtZSwgdmFsdWUsIHthbm9ueW1pemVJcDogdHJ1ZX0pLnNlbmQoKVxufVxuXG5mdW5jdGlvbiB0cmFja1N0cmluZ0NvbmZpZyhuYW1lLCB2YWx1ZSkge1xuICBnZXRVc2VyKCkuZXZlbnQoJ0NvbmZpZycsICdPTicsIGAke25hbWV9OiR7dmFsdWV9YCwge2Fub255bWl6ZUlwOiB0cnVlfSkuc2VuZCgpXG59XG5cbmZ1bmN0aW9uIHRyYWNrQ29uZmlnKG5hbWUsIHZhbHVlKSB7XG4gIGlmIChwYXJzZUludCh2YWx1ZSkgPj0gMCkge1xuICAgIHRyYWNrSW50Q29uZmlnSXNPbihuYW1lLCB2YWx1ZSlcbiAgfVxuICBlbHNlIGlmICh2YWx1ZSA9PT0gdHJ1ZSkge1xuICAgIHRyYWNrQm9vbGVhbkNvbmZpZ0lzT24obmFtZSlcbiAgfVxuICBlbHNlIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHtcbiAgICB0cmFja0Jvb2xlYW5Db25maWdJc09mZihuYW1lKVxuICB9XG4gIGVsc2UgaWYgKHZhbHVlLmNoYXJBdCkge1xuICAgIHRyYWNrU3RyaW5nQ29uZmlnKG5hbWUsIHZhbHVlKVxuICB9XG59XG5cbmZ1bmN0aW9uIHRyYWNrKG5hbWUpIHtcbiAgY29uc3QgY29uZmlnS2V5ID0gYGdpdC1wbHVzLiR7bmFtZX1gXG4gIGNvbnN0IGNvbmZpZyA9IENvbmZpZy5nZXQoY29uZmlnS2V5KVxuICBjb25zdCBzY2hlbWEgPSBDb25maWcuZ2V0U2NoZW1hKGNvbmZpZ0tleSlcbiAgaWYgKGNvbmZpZ0tleSA9PT0gJ2dpdC1wbHVzLmdlbmVyYWwuX2FuYWx5dGljc1VzZXJJZCcpIHJldHVyblxuICBpZiAoc2NoZW1hLnR5cGUgPT09ICdvYmplY3QnKSB7XG4gICAgT2JqZWN0LmtleXMoc2NoZW1hLnByb3BlcnRpZXMpLmZvckVhY2gocHJvcGVydHkgPT4gdHJhY2soYCR7bmFtZX0uJHtwcm9wZXJ0eX1gKSlcbiAgfVxuICBlbHNlIHtcbiAgICB0cmFja0NvbmZpZyhjb25maWdLZXksIGNvbmZpZylcbiAgfVxufVxuXG4vLyBmdW5jdGlvbiB0cmFja0NvbmZpZ0NoYW5nZWQobmFtZSwge29sZFZhbHVlLCBuZXdWYWx1ZX0pIHtcbi8vICAgZ2V0VXNlcigpLmV2ZW50KCdDb25maWcnLCAnQ0hBTkdFRCcsIG5hbWUsIHthbm9ueW1pemVJcDogdHJ1ZX0pLnNlbmQoKVxuLy8gfVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpIHtcbiAgLy8gbGV0IHVzZXJDb25maWdzID0gQ29uZmlnLmdldEFsbCgnZ2l0LXBsdXMnKVswXVxuICAvLyB1c2VyQ29uZmlncyA9IHVzZXJDb25maWdzLnZhbHVlXG4gIC8vIE9iamVjdC5rZXlzKHVzZXJDb25maWdzKS5mb3JFYWNoKHRyYWNrKVxuICAvLyBPYmplY3Qua2V5cyh1c2VyQ29uZmlncykuZm9yRWFjaChjb25maWcgPT4ge1xuICAvLyAgIGF0b20uY29uZmlnLm9uRGlkQ2hhbmdlKGBnaXQtcGx1cy4ke2NvbmZpZ31gLCBldmVudCA9PiB0cmFja0NvbmZpZ0NoYW5nZWQobmFtZSwgZXZlbnQpKVxuICAvLyB9KVxufVxuIl19